<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Wt: Wt::Dbo::Transaction Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Wt
   &#160;<span id="projectnumber">4.3.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespaceWt.html">Wt</a></li><li class="navelem"><a class="el" href="namespaceWt_1_1Dbo.html">Dbo</a></li><li class="navelem"><a class="el" href="classWt_1_1Dbo_1_1Transaction.html">Transaction</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classWt_1_1Dbo_1_1Transaction-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">Wt::Dbo::Transaction Class Reference<div class="ingroups"><a class="el" href="group__dbo.html">Database Objects (Wt::Dbo)</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>A database transaction.  
 <a href="classWt_1_1Dbo_1_1Transaction.html#details">More...</a></p>

<p><code>#include &lt;Wt/Dbo/Transaction.h&gt;</code></p>

<p>Inherited by Wt::Auth::Dbo::UserDatabase&lt; DboType &gt;::TransactionImpl.</p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ad617b2cb23bc0778ad2c534e2482f74c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWt_1_1Dbo_1_1Transaction.html#ad617b2cb23bc0778ad2c534e2482f74c">Transaction</a> (<a class="el" href="classWt_1_1Dbo_1_1Session.html">Session</a> &amp;<a class="el" href="classWt_1_1Dbo_1_1Transaction.html#a47fe1b5cab87a9d87eff76644df285c6">session</a>)</td></tr>
<tr class="memdesc:ad617b2cb23bc0778ad2c534e2482f74c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="#ad617b2cb23bc0778ad2c534e2482f74c">More...</a><br /></td></tr>
<tr class="separator:ad617b2cb23bc0778ad2c534e2482f74c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af04d5b754bdfd2d35c24be34eddb85c2"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWt_1_1Dbo_1_1Transaction.html#af04d5b754bdfd2d35c24be34eddb85c2">~Transaction</a> () noexcept(false)</td></tr>
<tr class="memdesc:af04d5b754bdfd2d35c24be34eddb85c2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor.  <a href="#af04d5b754bdfd2d35c24be34eddb85c2">More...</a><br /></td></tr>
<tr class="separator:af04d5b754bdfd2d35c24be34eddb85c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a519f1331028cabaaa0e728653cdf6e47"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWt_1_1Dbo_1_1Transaction.html#a519f1331028cabaaa0e728653cdf6e47">isActive</a> () const</td></tr>
<tr class="memdesc:a519f1331028cabaaa0e728653cdf6e47"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns whether the transaction is still active.  <a href="#a519f1331028cabaaa0e728653cdf6e47">More...</a><br /></td></tr>
<tr class="separator:a519f1331028cabaaa0e728653cdf6e47"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76e109abb03f00cf3ba5a5c6d84529a5"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWt_1_1Dbo_1_1Transaction.html#a76e109abb03f00cf3ba5a5c6d84529a5">commit</a> ()</td></tr>
<tr class="memdesc:a76e109abb03f00cf3ba5a5c6d84529a5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Commits the transaction.  <a href="#a76e109abb03f00cf3ba5a5c6d84529a5">More...</a><br /></td></tr>
<tr class="separator:a76e109abb03f00cf3ba5a5c6d84529a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a071848320ad21e06890fb30d4b6b46e9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWt_1_1Dbo_1_1Transaction.html#a071848320ad21e06890fb30d4b6b46e9">rollback</a> ()</td></tr>
<tr class="memdesc:a071848320ad21e06890fb30d4b6b46e9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rolls back the transaction.  <a href="#a071848320ad21e06890fb30d4b6b46e9">More...</a><br /></td></tr>
<tr class="separator:a071848320ad21e06890fb30d4b6b46e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a47fe1b5cab87a9d87eff76644df285c6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classWt_1_1Dbo_1_1Session.html">Session</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWt_1_1Dbo_1_1Transaction.html#a47fe1b5cab87a9d87eff76644df285c6">session</a> () const</td></tr>
<tr class="memdesc:a47fe1b5cab87a9d87eff76644df285c6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the session associated with this transaction.  <a href="#a47fe1b5cab87a9d87eff76644df285c6">More...</a><br /></td></tr>
<tr class="separator:a47fe1b5cab87a9d87eff76644df285c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd3ee2c8e349e843305d3710a8df7951"><td class="memItemLeft" align="right" valign="top"><a id="acd3ee2c8e349e843305d3710a8df7951"></a>
<a class="el" href="classWt_1_1Dbo_1_1SqlConnection.html">SqlConnection</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWt_1_1Dbo_1_1Transaction.html#acd3ee2c8e349e843305d3710a8df7951">connection</a> () const</td></tr>
<tr class="memdesc:acd3ee2c8e349e843305d3710a8df7951"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the connection used by this transaction. <br /></td></tr>
<tr class="separator:acd3ee2c8e349e843305d3710a8df7951"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>A database transaction. </p>
<p>This class implements a RAII transaction. Most dbo manipulations require that a transaction is active, and database changes will not be committed to the database until the active transaction is committed. A transaction can be committed using <a class="el" href="classWt_1_1Dbo_1_1Transaction.html#a76e109abb03f00cf3ba5a5c6d84529a5" title="Commits the transaction.">commit()</a>, but also commits automatically when it is deleted while no exception is being thrown (using std::uncaught_exception()). This means that it is possible that the transaction destructor throws an exception in case the transaction still needs to be committed, and the commit fails. If the transaction is deleted because of stack unwinding while an exception is thrown, then the transaction rolls back.</p>
<p>A transaction is active until it is either committed or rolled back. When a transaction is rolled back or fails, the modified database objects are not successfully synchronized with the database. A roll-back does not affect the value of the in memory database objects, so they may possibly be synchronized later in a new transaction or discarded using <a class="el" href="classWt_1_1Dbo_1_1Session.html#add5f4d579b9841072d5e777925acd92c" title="Rereads all objects.">Session::rereadAll()</a>.</p>
<p>In most occasions you will want to guard any method that touches the database using a transaction object on the stack.</p>
<p>But you may create multiple (nested) transaction objects at the same time: in this way you can guard a method with a transaction object even if it is called from another method which also defines a transaction at a wider scope. Nested transactions act in concert and reference the same logical transaction: the logical transaction will fail if at least one transaction fails, and will be committed only if all transactions are committed.</p>
<p>Usage example: </p><div class="fragment"><div class="line"><span class="keywordtype">void</span> doSomething(<a class="code" href="classWt_1_1Dbo_1_1Session.html">Wt::Dbo::Session</a>&amp; <a class="code" href="classWt_1_1Dbo_1_1Transaction.html#a47fe1b5cab87a9d87eff76644df285c6">session</a>)</div><div class="line">{</div><div class="line">  <a class="code" href="classWt_1_1Dbo_1_1Transaction.html">Wt::Dbo::Transaction</a> transaction(<a class="code" href="classWt_1_1Dbo_1_1Transaction.html#a47fe1b5cab87a9d87eff76644df285c6">session</a>);</div><div class="line"></div><div class="line">  <a class="code" href="classWt_1_1Dbo_1_1ptr.html">Wt::Dbo::ptr&lt;Account&gt;</a> a = <a class="code" href="classWt_1_1Dbo_1_1Transaction.html#a47fe1b5cab87a9d87eff76644df285c6">session</a>.<a class="code" href="classWt_1_1Dbo_1_1Session.html#acb4b7f2191237c16f14a3689915e164b">load</a>&lt;Account&gt;(42);</div><div class="line">  ...</div><div class="line"></div><div class="line">  <span class="comment">// the transaction will roll back if an exception is thrown, or</span></div><div class="line">  <span class="comment">// commit otherwise</span></div><div class="line">}</div></div><!-- fragment --> </div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="ad617b2cb23bc0778ad2c534e2482f74c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad617b2cb23bc0778ad2c534e2482f74c">&#9670;&nbsp;</a></span>Transaction()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Wt::Dbo::Transaction::Transaction </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classWt_1_1Dbo_1_1Session.html">Session</a> &amp;&#160;</td>
          <td class="paramname"><em>session</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">explicit</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Constructor. </p>
<p>Opens a transaction for the given <code>session</code>. If a transaction is already open for the session, this transaction is added. All open transactions must commit successfully for the entire transaction to succeed. </p>

</div>
</div>
<a id="af04d5b754bdfd2d35c24be34eddb85c2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af04d5b754bdfd2d35c24be34eddb85c2">&#9670;&nbsp;</a></span>~Transaction()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual Wt::Dbo::Transaction::~Transaction </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Destructor. </p>
<p>If the transaction is still active, it is rolled back. </p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a76e109abb03f00cf3ba5a5c6d84529a5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a76e109abb03f00cf3ba5a5c6d84529a5">&#9670;&nbsp;</a></span>commit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool Wt::Dbo::Transaction::commit </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Commits the transaction. </p>
<p>If this is the last open transaction for the session, the session is flushed and pending changes are committed to the database.</p>
<p>Returns whether the transaction was flushed to the database (i.e. whether this was indeed the last open transaction).</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classWt_1_1Dbo_1_1Transaction.html#a071848320ad21e06890fb30d4b6b46e9" title="Rolls back the transaction.">rollback()</a> </dd></dl>

</div>
</div>
<a id="a519f1331028cabaaa0e728653cdf6e47"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a519f1331028cabaaa0e728653cdf6e47">&#9670;&nbsp;</a></span>isActive()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool Wt::Dbo::Transaction::isActive </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns whether the transaction is still active. </p>
<p>A transaction is active unless it has been committed or rolled back.</p>
<p>While a transaction is active, new transactions for the same session are treated as nested transactions. </p>

</div>
</div>
<a id="a071848320ad21e06890fb30d4b6b46e9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a071848320ad21e06890fb30d4b6b46e9">&#9670;&nbsp;</a></span>rollback()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Wt::Dbo::Transaction::rollback </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Rolls back the transaction. </p>
<p>The transaction is rolled back (if it was still active), and is no longer active.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classWt_1_1Dbo_1_1Transaction.html#a76e109abb03f00cf3ba5a5c6d84529a5" title="Commits the transaction.">commit()</a> </dd></dl>

</div>
</div>
<a id="a47fe1b5cab87a9d87eff76644df285c6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a47fe1b5cab87a9d87eff76644df285c6">&#9670;&nbsp;</a></span>session()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classWt_1_1Dbo_1_1Session.html">Session</a>&amp; Wt::Dbo::Transaction::session </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the session associated with this transaction. </p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classWt_1_1Dbo_1_1Transaction.html#ad617b2cb23bc0778ad2c534e2482f74c" title="Constructor.">Transaction()</a> </dd></dl>

</div>
</div>
</div><!-- contents -->
<hr size="1"><address style="text-align: right; margin: 3px"><small>
Generated on Wed Apr 22 2020 for <a href="http://www.webtoolkit.eu/wt">the
C++ Web Toolkit (Wt)</a> by&nbsp;<a
href="http://www.doxygen.org/index.html"><img src="doxygen.png"
alt="doxygen" border="0" style="vertical-align: middle; display:
inline-block; height: 2em"></a> 1.8.15</small></address>
</body>
</html>
