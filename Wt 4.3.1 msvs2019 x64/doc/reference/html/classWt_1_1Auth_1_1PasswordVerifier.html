<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Wt: Wt::Auth::PasswordVerifier Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Wt
   &#160;<span id="projectnumber">4.3.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespaceWt.html">Wt</a></li><li class="navelem"><a class="el" href="namespaceWt_1_1Auth.html">Auth</a></li><li class="navelem"><a class="el" href="classWt_1_1Auth_1_1PasswordVerifier.html">PasswordVerifier</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classWt_1_1Auth_1_1PasswordVerifier-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">Wt::Auth::PasswordVerifier Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Password hash computation and verification class.  
 <a href="classWt_1_1Auth_1_1PasswordVerifier.html#details">More...</a></p>

<p><code>#include &lt;Wt/Auth/PasswordVerifier.h&gt;</code></p>
<div class="dynheader">
Inheritance diagram for Wt::Auth::PasswordVerifier:</div>
<div class="dyncontent">
<div class="center"><img src="classWt_1_1Auth_1_1PasswordVerifier__inherit__graph.png" border="0" usemap="#Wt_1_1Auth_1_1PasswordVerifier_inherit__map" alt="Inheritance graph"/></div>
<map name="Wt_1_1Auth_1_1PasswordVerifier_inherit__map" id="Wt_1_1Auth_1_1PasswordVerifier_inherit__map">
<area shape="rect"  title="Password hash computation and verification class." alt="" coords="7,95,185,121"/>
<area shape="rect"  href="classWt_1_1Auth_1_1PasswordService_1_1AbstractVerifier.html" title="Abstract password hash computation and verification class." alt="" coords="5,5,187,47"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a3aa61534cbd936e01599d55dfe001d23"><td class="memItemLeft" align="right" valign="top"><a id="a3aa61534cbd936e01599d55dfe001d23"></a>
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWt_1_1Auth_1_1PasswordVerifier.html#a3aa61534cbd936e01599d55dfe001d23">PasswordVerifier</a> ()</td></tr>
<tr class="memdesc:a3aa61534cbd936e01599d55dfe001d23"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor. <br /></td></tr>
<tr class="separator:a3aa61534cbd936e01599d55dfe001d23"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2dad75b97560325d3d242dd074f0af11"><td class="memItemLeft" align="right" valign="top"><a id="a2dad75b97560325d3d242dd074f0af11"></a>
virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWt_1_1Auth_1_1PasswordVerifier.html#a2dad75b97560325d3d242dd074f0af11">~PasswordVerifier</a> ()</td></tr>
<tr class="memdesc:a2dad75b97560325d3d242dd074f0af11"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor. <br /></td></tr>
<tr class="separator:a2dad75b97560325d3d242dd074f0af11"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8fdc288c1d54b7e0dedbab982ad4bf26"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWt_1_1Auth_1_1PasswordVerifier.html#a8fdc288c1d54b7e0dedbab982ad4bf26">setSaltLength</a> (int words)</td></tr>
<tr class="memdesc:a8fdc288c1d54b7e0dedbab982ad4bf26"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the salt length.  <a href="#a8fdc288c1d54b7e0dedbab982ad4bf26">More...</a><br /></td></tr>
<tr class="separator:a8fdc288c1d54b7e0dedbab982ad4bf26"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a54f3ebd1c38048059d8e197bc385cf0b"><td class="memItemLeft" align="right" valign="top"><a id="a54f3ebd1c38048059d8e197bc385cf0b"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWt_1_1Auth_1_1PasswordVerifier.html#a54f3ebd1c38048059d8e197bc385cf0b">saltLength</a> () const</td></tr>
<tr class="memdesc:a54f3ebd1c38048059d8e197bc385cf0b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the salt length. <br /></td></tr>
<tr class="separator:a54f3ebd1c38048059d8e197bc385cf0b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af925131513a9f2e6fe2e28c6807c8aa3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWt_1_1Auth_1_1PasswordVerifier.html#af925131513a9f2e6fe2e28c6807c8aa3">addHashFunction</a> (std::unique_ptr&lt; <a class="el" href="classWt_1_1Auth_1_1HashFunction.html">HashFunction</a> &gt; function)</td></tr>
<tr class="memdesc:af925131513a9f2e6fe2e28c6807c8aa3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds a hash function.  <a href="#af925131513a9f2e6fe2e28c6807c8aa3">More...</a><br /></td></tr>
<tr class="separator:af925131513a9f2e6fe2e28c6807c8aa3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a815bdcc006284eaec520d39502e387ef"><td class="memItemLeft" align="right" valign="top">const std::vector&lt; <a class="el" href="classWt_1_1Auth_1_1HashFunction.html">HashFunction</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWt_1_1Auth_1_1PasswordVerifier.html#a815bdcc006284eaec520d39502e387ef">hashFunctions</a> () const</td></tr>
<tr class="memdesc:a815bdcc006284eaec520d39502e387ef"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the list of hash functions.  <a href="#a815bdcc006284eaec520d39502e387ef">More...</a><br /></td></tr>
<tr class="separator:a815bdcc006284eaec520d39502e387ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c80abe9a4144fc49417d19ab7eaf4a0"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWt_1_1Auth_1_1PasswordVerifier.html#a4c80abe9a4144fc49417d19ab7eaf4a0">needsUpdate</a> (const <a class="el" href="classWt_1_1Auth_1_1PasswordHash.html">PasswordHash</a> &amp;hash) const override</td></tr>
<tr class="memdesc:a4c80abe9a4144fc49417d19ab7eaf4a0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns whether a password hash needs to be updated (recomputed).  <a href="#a4c80abe9a4144fc49417d19ab7eaf4a0">More...</a><br /></td></tr>
<tr class="separator:a4c80abe9a4144fc49417d19ab7eaf4a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5e9987d711a06ca1564982c32594d89"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classWt_1_1Auth_1_1PasswordHash.html">PasswordHash</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWt_1_1Auth_1_1PasswordVerifier.html#ae5e9987d711a06ca1564982c32594d89">hashPassword</a> (const <a class="el" href="classWt_1_1WString.html">WString</a> &amp;password) const override</td></tr>
<tr class="memdesc:ae5e9987d711a06ca1564982c32594d89"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the password hash for a clear text password.  <a href="#ae5e9987d711a06ca1564982c32594d89">More...</a><br /></td></tr>
<tr class="separator:ae5e9987d711a06ca1564982c32594d89"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a105428de559553a2df55b72a4d3779fa"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWt_1_1Auth_1_1PasswordVerifier.html#a105428de559553a2df55b72a4d3779fa">verify</a> (const <a class="el" href="classWt_1_1WString.html">WString</a> &amp;password, const <a class="el" href="classWt_1_1Auth_1_1PasswordHash.html">PasswordHash</a> &amp;hash) const override</td></tr>
<tr class="memdesc:a105428de559553a2df55b72a4d3779fa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Verifies a password against a hash.  <a href="#a105428de559553a2df55b72a4d3779fa">More...</a><br /></td></tr>
<tr class="separator:a105428de559553a2df55b72a4d3779fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classWt_1_1Auth_1_1PasswordService_1_1AbstractVerifier"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classWt_1_1Auth_1_1PasswordService_1_1AbstractVerifier')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classWt_1_1Auth_1_1PasswordService_1_1AbstractVerifier.html">Wt::Auth::PasswordService::AbstractVerifier</a></td></tr>
<tr class="memitem:adc3bbdb3321ba23496a366526daf9ed3 inherit pub_methods_classWt_1_1Auth_1_1PasswordService_1_1AbstractVerifier"><td class="memItemLeft" align="right" valign="top"><a id="adc3bbdb3321ba23496a366526daf9ed3"></a>
virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWt_1_1Auth_1_1PasswordService_1_1AbstractVerifier.html#adc3bbdb3321ba23496a366526daf9ed3">~AbstractVerifier</a> ()</td></tr>
<tr class="memdesc:adc3bbdb3321ba23496a366526daf9ed3 inherit pub_methods_classWt_1_1Auth_1_1PasswordService_1_1AbstractVerifier"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor. <br /></td></tr>
<tr class="separator:adc3bbdb3321ba23496a366526daf9ed3 inherit pub_methods_classWt_1_1Auth_1_1PasswordService_1_1AbstractVerifier"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Password hash computation and verification class. </p>
<p>This class implements the logic for comparing passwords against password hashes, or computing a new password hash for a password.</p>
<p>One or more hash functions can be added, which allow you to introduce a new "preferred" hash function while maintaining support for verifying existing passwords hashes. </p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="af925131513a9f2e6fe2e28c6807c8aa3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af925131513a9f2e6fe2e28c6807c8aa3">&#9670;&nbsp;</a></span>addHashFunction()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Wt::Auth::PasswordVerifier::addHashFunction </td>
          <td>(</td>
          <td class="paramtype">std::unique_ptr&lt; <a class="el" href="classWt_1_1Auth_1_1HashFunction.html">HashFunction</a> &gt;&#160;</td>
          <td class="paramname"><em>function</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adds a hash function. </p>
<p>The first hash function added is the one that will be used for creating new password hashes, i.e. the "preferred" hash function. The other hash functions are used only for verifying existing hash passwords. This allows you to move to new hash functions as other ones are no longer deemed secure.</p>
<p>Each hash function has a unique name, which is annotated in the generated hash to identify the appropriate hash funtion to evaluate it.</p>
<p>Ownership of the hash functions is transferred.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classWt_1_1Auth_1_1PasswordVerifier.html#a815bdcc006284eaec520d39502e387ef" title="Returns the list of hash functions.">hashFunctions()</a> </dd></dl>

</div>
</div>
<a id="a815bdcc006284eaec520d39502e387ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a815bdcc006284eaec520d39502e387ef">&#9670;&nbsp;</a></span>hashFunctions()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const std::vector&lt;<a class="el" href="classWt_1_1Auth_1_1HashFunction.html">HashFunction</a> *&gt; Wt::Auth::PasswordVerifier::hashFunctions </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the list of hash functions. </p>
<p>This returns a list with references to hashfunctions that have been added with <a class="el" href="classWt_1_1Auth_1_1PasswordVerifier.html#af925131513a9f2e6fe2e28c6807c8aa3" title="Adds a hash function.">addHashFunction()</a>. </p>

</div>
</div>
<a id="ae5e9987d711a06ca1564982c32594d89"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae5e9987d711a06ca1564982c32594d89">&#9670;&nbsp;</a></span>hashPassword()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classWt_1_1Auth_1_1PasswordHash.html">PasswordHash</a> Wt::Auth::PasswordVerifier::hashPassword </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classWt_1_1WString.html">WString</a> &amp;&#160;</td>
          <td class="paramname"><em>password</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Computes the password hash for a clear text password. </p>
<p>This creates new salt and applies the "preferred" hash function to the salt and clear text password to compute the hash.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classWt_1_1Auth_1_1PasswordVerifier.html#a105428de559553a2df55b72a4d3779fa" title="Verifies a password against a hash.">verify()</a> </dd></dl>

<p>Implements <a class="el" href="classWt_1_1Auth_1_1PasswordService_1_1AbstractVerifier.html#a6c0edcfd38d6c4a656ffded44b007023">Wt::Auth::PasswordService::AbstractVerifier</a>.</p>

</div>
</div>
<a id="a4c80abe9a4144fc49417d19ab7eaf4a0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4c80abe9a4144fc49417d19ab7eaf4a0">&#9670;&nbsp;</a></span>needsUpdate()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual bool Wt::Auth::PasswordVerifier::needsUpdate </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classWt_1_1Auth_1_1PasswordHash.html">PasswordHash</a> &amp;&#160;</td>
          <td class="paramname"><em>hash</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns whether a password hash needs to be updated (recomputed). </p>
<p>A <code>hash</code> may need to be updated if it has been computed with a cryptographic method that is being disfavoured. </p>

<p>Implements <a class="el" href="classWt_1_1Auth_1_1PasswordService_1_1AbstractVerifier.html#a9991518e71092b356ae4e66fede088c3">Wt::Auth::PasswordService::AbstractVerifier</a>.</p>

</div>
</div>
<a id="a8fdc288c1d54b7e0dedbab982ad4bf26"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8fdc288c1d54b7e0dedbab982ad4bf26">&#9670;&nbsp;</a></span>setSaltLength()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Wt::Auth::PasswordVerifier::setSaltLength </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>words</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the salt length. </p>
<p>The salt length is used to create new salt when a new password is being hashed.</p>
<p>The salt length is specified in bytes, but should be a multiple of 3 (so that Base64 encoding yields an integral number of bytes).</p>
<p>The default length is 12.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classWt_1_1Auth_1_1PasswordVerifier.html#ae5e9987d711a06ca1564982c32594d89" title="Computes the password hash for a clear text password.">hashPassword()</a> </dd></dl>

</div>
</div>
<a id="a105428de559553a2df55b72a4d3779fa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a105428de559553a2df55b72a4d3779fa">&#9670;&nbsp;</a></span>verify()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual bool Wt::Auth::PasswordVerifier::verify </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classWt_1_1WString.html">WString</a> &amp;&#160;</td>
          <td class="paramname"><em>password</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classWt_1_1Auth_1_1PasswordHash.html">PasswordHash</a> &amp;&#160;</td>
          <td class="paramname"><em>hash</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Verifies a password against a hash. </p>
<p>This verifies whether the password matches the hash.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classWt_1_1Auth_1_1PasswordVerifier.html#ae5e9987d711a06ca1564982c32594d89" title="Computes the password hash for a clear text password.">hashPassword()</a> </dd></dl>

<p>Implements <a class="el" href="classWt_1_1Auth_1_1PasswordService_1_1AbstractVerifier.html#a90b8136ba2c6f77fe420445653f56a6a">Wt::Auth::PasswordService::AbstractVerifier</a>.</p>

</div>
</div>
</div><!-- contents -->
<hr size="1"><address style="text-align: right; margin: 3px"><small>
Generated on Wed Apr 22 2020 for <a href="http://www.webtoolkit.eu/wt">the
C++ Web Toolkit (Wt)</a> by&nbsp;<a
href="http://www.doxygen.org/index.html"><img src="doxygen.png"
alt="doxygen" border="0" style="vertical-align: middle; display:
inline-block; height: 2em"></a> 1.8.15</small></address>
</body>
</html>
